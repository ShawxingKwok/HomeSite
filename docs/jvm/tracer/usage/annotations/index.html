<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Tracer annotations package is pers.shawxingkwok.tracer rather than that in videos. Introduction # The pictures above highlight the disadvantages of the general model style. Now, with Kotlin-JVM, KSP, and minimal configuration, Tracer generates extensional properties oriented toward internal traceable elements, which realizes dependency injection in a novel way.
Tracer has several main advantages over common DI tools, as listed below:
Minimal configuration. Powerful: generic types and variances are parsable, and it can trace super types as well."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Annotations"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://shawxingkwok.github.io/ITWorks/docs/jvm/tracer/usage/annotations/"><title>Annotations | ITWorks</title>
<link rel=manifest href=/ITWorks/manifest.json><link rel=icon href=/ITWorks/favicon.png type=image/x-icon><link rel=stylesheet href=/ITWorks/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/ITWorks/flexsearch.min.js></script><script defer src=/ITWorks/en.search.min.ed93006d887fe830a40f983c60c8998c83bbf91c5e1c77f0b572ac20996fdaa9.js integrity="sha256-7ZMAbYh/6DCkD5g8YMiZjIO7+RxeHHfwtXKsIJlv2qk=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://shawxingkwok.github.io/ITWorks/docs/jvm/tracer/usage/annotations/index.xml title=ITWorks></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/ITWorks/><span>ITWorks</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>Multiplatform</span><ul><li><a href=/ITWorks/docs/multiplatform/phone/>Phone</a><ul></ul></li><li><a href=/ITWorks/docs/multiplatform/kt-util/>Kt util</a><ul></ul></li><li><span>MVB</span><ul><li><a href=/ITWorks/docs/multiplatform/mvb/android/>Android</a><ul></ul></li><li><a href=/ITWorks/docs/multiplatform/mvb/proposal/>New UI design proposal</a><ul></ul></li></ul></li></ul></li><li><span>Jvm</span><ul><li><input type=checkbox id=section-f25bd71e28f95a08738fe572911bbd65 class=toggle checked>
<label for=section-f25bd71e28f95a08738fe572911bbd65 class="flex justify-between"><a role=button>Tracer</a></label><ul><li><a href=/ITWorks/docs/jvm/tracer/setup/>Setup</a><ul></ul></li><li><span>Usage</span><ul><li><a href=/ITWorks/docs/jvm/tracer/usage/annotations/ class=active>Annotations</a><ul></ul></li><li><a href=/ITWorks/docs/jvm/tracer/usage/naming-rules/>Naming rules</a><ul></ul></li><li><a href=/ITWorks/docs/jvm/tracer/usage/details/>Details</a><ul></ul></li><li><a href=/ITWorks/docs/jvm/tracer/usage/notes/>Notes</a><ul></ul></li><li><a href=/ITWorks/docs/jvm/tracer/usage/practice/>Practice</a><ul></ul></li><li><a href=/ITWorks/docs/jvm/tracer/usage/test/>Test</a><ul></ul></li></ul></li><li><input type=checkbox id=section-df9c64161b156bfffd3c37819ba87474 class=toggle>
<label for=section-df9c64161b156bfffd3c37819ba87474 class="flex justify-between"><a role=button>Road map</a></label><ul><li><a href=/ITWorks/docs/jvm/tracer/road-map/short-term/>Short term</a><ul></ul></li><li><a href=/ITWorks/docs/jvm/tracer/road-map/long-term/>Long term</a><ul></ul></li><li><a href=/ITWorks/docs/jvm/tracer/road-map/With-kcp/>With Kcp</a><ul></ul></li></ul></li><li><span>Extensions</span><ul><li><a href=/ITWorks/docs/jvm/tracer/extensions/android/>Android-view</a><ul></ul></li></ul></li><li><a href=https://github.com/ShawxingKwok/Tracer target=_blank>Github repo</a><ul></ul></li></ul></li></ul></li><li><span>Android</span><ul><li><a href=/ITWorks/docs/android/util-core/>Util-core</a><ul></ul></li><li><a href=/ITWorks/docs/android/util-view/>Util-view</a><ul></ul></li><li><input type=checkbox id=section-48404a5524d1704bcb4add35c067ddd2 class=toggle>
<label for=section-48404a5524d1704bcb4add35c067ddd2 class="flex justify-between"><a role=button>KDataStore</a></label><ul><li><a href=/ITWorks/docs/android/kdatastore/en/>English</a><ul></ul></li><li><a href=/ITWorks/docs/android/kdatastore/cn/>中文</a><ul></ul></li></ul></li></ul></li></ul><br><ul><li><a href=/ITWorks/post/about/>About</a></li><li><a href=/ITWorks/post/sponsor/>Sponsor</a></li><li><a href=https://github.com/ShawxingKwok target=_blank rel=noopener>Github</a></li><li><a href=mailto:ShawxingKwok@126.com target=_blank rel=noopener>Email</a></li><li><a href=/ITWorks/post/license/>License</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/ITWorks/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Annotations</strong>
<label for=toc-control><img src=/ITWorks/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#root>Root</a></li><li><a href=#nodes>Nodes</a></li><li><a href=#tip>Tip</a></li><li><a href=#omit>Omit</a></li></ul></nav></aside></header><article class=markdown><blockquote class="book-hint warning">Tracer annotations package is <code>pers.shawxingkwok.tracer</code> rather than that in videos.</blockquote><h1 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h1><p><image src=singleBedroomHouse.png width=300></image></p><div style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px"><img src=general.png alt></div><p>The pictures above highlight the disadvantages of the general model style. Now, with <code>Kotlin-JVM</code>, <code>KSP</code>,
and minimal configuration, <code>Tracer</code> generates extensional properties oriented toward internal traceable
elements, which realizes <strong>dependency injection</strong> in a novel way.</p><p><code>Tracer</code> has several main advantages over common DI tools, as listed below:</p><ul><li>Minimal configuration.</li><li>Powerful: generic types and variances are parsable, and it can trace super types as well.</li><li>Fast: operates without runtime cache or reflection.</li></ul><p>Contents below tell how <code>Tracer</code> models and extends relationships as shown in the top picture.</p><h1 id=root>Root
<a class=anchor href=#root>#</a></h1><p>Each class with <code>@Tracer.Root</code> is considered as the trace start point, followed by its interior
public/internal elements.</p><ol><li><p>Annotate the source class (<code>House</code> in this case) with <code>Tracer</code> annotations.</p></li><li><p>Build.</p></li><li><p>Model with the generated tracer interfaces (<code>HouseTracer</code>).
<video controls preload=auto width=100% playsinline class=html-video>
<source src=/ITWorks/docs/jvm/tracer/usage/annotations/model.mp4 type=video/mp4><span>Your browser doesn't support embedded videos, but don't worry, you can <a href=/ITWorks/docs/jvm/tracer/usage/annotations/model.mp4>download it</a> and watch it with your favorite video player!</span></video></p></li><li><p>Rebuild. There generates element traces as below.<div style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px"><img src=generation.png alt></div></p></li><li><p>Inject
<video controls preload=auto width=100% playsinline class=html-video>
<source src=/ITWorks/docs/jvm/tracer/usage/annotations/inject.mp4 type=video/mp4><span>Your browser doesn't support embedded videos, but don't worry, you can <a href=/ITWorks/docs/jvm/tracer/usage/annotations/inject.mp4>download it</a> and watch it with your favorite video player!</span></video></p></li></ol><blockquote class="book-hint info">The renaming problem could be solved by an IDE plugin that has not come out yet.</blockquote><h1 id=nodes>Nodes
<a class=anchor href=#nodes>#</a></h1><p>There are some traced properties with the same type. If all their interior properties are traced with recurse from the root class, the
generated traces would be huge and chaotic. Considering from a different perspective, repeatedly constructed
objects should maintain independence in design, so that they do not require deep exploration when called.
Take the example of a car model, you might access the cost of the wheels from the outside, but there is no need
to drill down to the specific prices of the tires and axles.</p><p>Now we add one bedroom and its some inner objects as below. As nodes grow on root or other nodes,
<code>Door</code> <code>LivingRoom</code> and <code>WifiRouter</code> are all built once and each of them represents <strong>node</strong>;
<code>Bedroom</code> is repeatedly built and represents <strong>nodes</strong>.</p><p>Now objects in the left picture are traced in the file <code>HouseElements</code>, and objects in the right picture
are traced in the file <code>BedroomElements</code>. Note that, <code>OuterHouseTracer</code> is extended by <code>BedroomTracer</code>, making
<code>HouseElements</code> starting with double <code>_</code> acquirable from <code>BedroomTracer</code>.</p><img src=../doubleBedroomsHouse.png><br><br><p><video controls preload=auto width=100% playsinline class=html-video>
<source src=/ITWorks/docs/jvm/tracer/usage/annotations/_nodes.mp4 type=video/mp4><span>Your browser doesn't support embedded videos, but don't worry, you can <a href=/ITWorks/docs/jvm/tracer/usage/annotations/_nodes.mp4>download it</a> and watch it with your favorite video player!</span></video><br></p><p>Generated code<div class=book-tabs><input type=radio class=toggle name=tabs-nodes id=tabs-nodes-0 checked>
<label for=tabs-nodes-0>House</label><div class="book-tabs-content markdown-inner"><div style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px"><img src=houseTracers.png alt></div><br><div style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px"><img src=houseElements.png alt></div></div><input type=radio class=toggle name=tabs-nodes id=tabs-nodes-1>
<label for=tabs-nodes-1>Bedroom</label><div class="book-tabs-content markdown-inner"><div style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px"><img src=bedroomTracers.png alt></div><br><div style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px"><img src=bedroomElements.png alt></div></div></div></p><h1 id=tip>Tip
<a class=anchor href=#tip>#</a></h1><p><code>Tracer.Tip</code> represents the trace end, which means the carrier&rsquo;s elements are never traced.</p><p><video controls preload=auto width=100% playsinline class=html-video>
<source src=/ITWorks/docs/jvm/tracer/usage/annotations/tip.mp4 type=video/mp4><span>Your browser doesn't support embedded videos, but don't worry, you can <a href=/ITWorks/docs/jvm/tracer/usage/annotations/tip.mp4>download it</a> and watch it with your favorite video player!</span></video><blockquote class="book-hint info">Context and the tracer interface are needless in a simple test.</blockquote></p><p>Elements or their type classes with features below are also considered as trace ends, meaning
they are never traced insides. Like classes with <code>Tracer.Root</code>, they should be designed independently
and avoid being exploring too insides.</p><ul><li><code>Tracer.Root</code>, <code>Tracer.Nodes</code></li><li>Interface, enum, object</li><li>Nullable</li><li>Foreign (from other modules, generated code, or Java files)</li><li>Rebuilt symbols<ul><li>Constructor is not single and empty.</li><li>Generic</li><li>Abstract / open</li></ul></li></ul><img style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px" src=trace%20ends.png width alt><p>Those <code>x</code> are not traced.
<img style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px" src=_trace%20ends.png width=680 alt></p><h1 id=omit>Omit
<a class=anchor href=#omit>#</a></h1><p><code>Properties</code> and <code>super types</code> with <code>@Tracer.Omit</code> would be omitted, which is generally used
with some unsupported new syntaxes, like <code>context receiver</code>.
Super type trace rules are later explained on page &lsquo;Details&rsquo;.<br><br>Source code<div style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px"><img src=omit.png alt></div><br><code>i</code> with <code>context receiver</code> is omitted in generated code now.<div style="border:1px solid #000;padding-left:10px;padding-top:10px;padding-right:10px"><img src=_omit.png alt></div><blockquote class="book-hint info"><code>Tracer interfaces</code> are not essential to implement in simple tests.</blockquote></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/ShawxingKwok/ITWorks/blob/main/content/docs/jvm/tracer/usage/annotations/_index.md target=_blank rel=noopener><img src=/ITWorks/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#root>Root</a></li><li><a href=#nodes>Nodes</a></li><li><a href=#tip>Tip</a></li><li><a href=#omit>Omit</a></li></ul></nav></div></aside></main></body></html>